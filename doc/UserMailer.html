<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: UserMailer
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (U)</a> &raquo;
    
    
    <span class="title">UserMailer</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: UserMailer
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ActionMailer::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActionMailer::Base</li>
          
            <li class="next">UserMailer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/mailers/user_mailer.rb</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#beta_notification-instance_method" title="#beta_notification (instance method)">- (Object) <strong>beta_notification</strong>(name, email, userType, beta) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>INTERNAL.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection_invite-instance_method" title="#connection_invite (instance method)">- (Object) <strong>connection_invite</strong>(user, emails, url, message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deliver_forgot_password-instance_method" title="#deliver_forgot_password (instance method)">- (Object) <strong>deliver_forgot_password</strong>(email, name, pass) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#event_invite_email-instance_method" title="#event_invite_email (instance method)">- (Object) <strong>event_invite_email</strong>(teachername, emails, message, event, user = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#five_referrals-instance_method" title="#five_referrals (instance method)">- (Object) <strong>five_referrals</strong>(email) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#interview_notification-instance_method" title="#interview_notification (instance method)">- (Object) <strong>interview_notification</strong>(teacher_id, job_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#interview_scheduled-instance_method" title="#interview_scheduled (instance method)">- (Object) <strong>interview_scheduled</strong>(user_id, job_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#message_notification-instance_method" title="#message_notification (instance method)">- (Object) <strong>message_notification</strong>(user_id, subject, body, id, name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#refer_job_email-instance_method" title="#refer_job_email (instance method)">- (Object) <strong>refer_job_email</strong>(teachername, job_id, name, emails) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#refer_site_email-instance_method" title="#refer_site_email (instance method)">- (Object) <strong>refer_site_email</strong>(teachername, emails, message, user = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rejection_notification-instance_method" title="#rejection_notification (instance method)">- (Object) <strong>rejection_notification</strong>(teacher_id, job_id, name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#school_signup_email-instance_method" title="#school_signup_email (instance method)">- (Object) <strong>school_signup_email</strong>(name, schoolname, email, phonenumber, school) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_passcode-instance_method" title="#send_passcode (instance method)">- (Object) <strong>send_passcode</strong>(name, email) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#teacher_applied-instance_method" title="#teacher_applied (instance method)">- (Object) <strong>teacher_applied</strong>(school_id, job_id, teacher_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#teacher_welcome_email-instance_method" title="#teacher_welcome_email (instance method)">- (Object) <strong>teacher_welcome_email</strong>(user_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#teacher_welcome_email_temppassword-instance_method" title="#teacher_welcome_email_temppassword (instance method)">- (Object) <strong>teacher_welcome_email_temppassword</strong>(user_id, password) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#userconnect-instance_method" title="#userconnect (instance method)">- (Object) <strong>userconnect</strong>(owner_id, user_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vouch_request-instance_method" title="#vouch_request (instance method)">- (Object) <strong>vouch_request</strong>(voucheename, vouchername, emails, url) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#weeklyemail-instance_method" title="#weeklyemail (instance method)">- (Object) <strong>weeklyemail</strong>(teacher) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="beta_notification-instance_method">
  
    - (<tt>Object</tt>) <strong>beta_notification</strong>(name, email, userType, beta) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>INTERNAL</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 174</span>

<span class='kw'>def</span> <span class='id identifier rubyid_beta_notification'>beta_notification</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_userType'>userType</span><span class='comma'>,</span> <span class='id identifier rubyid_beta'>beta</span><span class='rparen'>)</span>    
	<span class='id identifier rubyid_userTypes'>userTypes</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Teacher</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Teacher Assistant</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Student Teacher</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Administrator</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span>

	<span class='id identifier rubyid_betaProgram'>betaProgram</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Not a tester</span><span class='tstring_end'>'</span></span>
	<span class='kw'>if</span> <span class='id identifier rubyid_beta'>beta</span> <span class='op'>==</span> <span class='kw'>true</span>
		<span class='id identifier rubyid_betaProgram'>betaProgram</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Applied</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>if</span> <span class='id identifier rubyid_userType'>userType</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>||</span> <span class='id identifier rubyid_userType'>userType</span> <span class='op'>==</span> <span class='int'>2</span> <span class='op'>||</span> <span class='id identifier rubyid_userType'>userType</span> <span class='op'>==</span> <span class='int'>3</span>
			<span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send_passcode'>send_passcode</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver'>deliver</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tioki@tioki.com</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>[Tioki] New Beta Signup</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A new user has registered via the landing page.\n\nName: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>\nEmail: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_email'>email</span><span class='rbrace'>}</span><span class='tstring_content'>\n\nUser Type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_userTypes'>userTypes</span><span class='lbracket'>[</span><span class='id identifier rubyid_userType'>userType</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>\nBeta Program: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_betaProgram'>betaProgram</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

		<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
			<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>beta_notification</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connection_invite-instance_method">
  
    - (<tt>Object</tt>) <strong>connection_invite</strong>(user, emails, url, message) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_invite'>connection_invite</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
	<span class='ivar'>@teachername</span><span class='op'>=</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
	<span class='ivar'>@url</span><span class='op'>=</span> <span class='id identifier rubyid_url'>url</span>
	<span class='ivar'>@message</span><span class='op'>=</span> <span class='id identifier rubyid_message'>message</span>
	<span class='ivar'>@user</span><span class='op'>=</span><span class='id identifier rubyid_user'>user</span>

	<span class='comment'># Which template to use
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:connection_invite</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>connection_invite_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='comment'># Send out the email
</span>	<span class='comment'># Use new subject lines
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_ab'>ab</span> <span class='op'>==</span> <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
		<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teachername</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> wants you to checkout Tioki!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
			<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teachername</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> wants to connect on Tioki!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
			<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>connection_invite:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deliver_forgot_password-instance_method">
  
    - (<tt>Object</tt>) <strong>deliver_forgot_password</strong>(email, name, pass) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


148
149
150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deliver_forgot_password'>deliver_forgot_password</span><span class='lparen'>(</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_pass'>pass</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>[Tioki] Password Reset</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You have requested a password reset through our site. Your new password is:\n\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pass'>pass</span><span class='rbrace'>}</span><span class='tstring_content'>\n\nPlease login and change it at your earliest convenience.\n\nRegards,\nThe Tioki Team\nhttp://tioki.com</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>deliver_forgot_password</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="event_invite_email-instance_method">
  
    - (<tt>Object</tt>) <strong>event_invite_email</strong>(teachername, emails, message, event, user = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 247</span>

<span class='kw'>def</span> <span class='id identifier rubyid_event_invite_email'>event_invite_email</span><span class='lparen'>(</span><span class='id identifier rubyid_teachername'>teachername</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_event'>event</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>

	<span class='comment'># Set variables for use inside the email itself
</span>	<span class='ivar'>@teachername</span> <span class='op'>=</span> <span class='id identifier rubyid_teachername'>teachername</span>
	<span class='ivar'>@message</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span>

	<span class='comment'># Source the event itself
</span>	<span class='ivar'>@event</span> <span class='op'>=</span> <span class='id identifier rubyid_event'>event</span>

	<span class='comment'># Get the refering ID
</span>	<span class='ivar'>@referer</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

	<span class='comment'># Set the subject for the email
</span>	<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span>  <span class='ivar'>@teachername</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> wants you to check out an upcoming event on Tioki!</span><span class='tstring_end'>'</span></span>

	<span class='comment'># Which template to use
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:event_invite</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>event_invite_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='comment'># Send out the email
</span>	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
		<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>event_invite_email:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="five_referrals-instance_method">
  
    - (<tt>Object</tt>) <strong>five_referrals</strong>(email) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


443
444
445
446
447
448
449
450
451</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 443</span>

<span class='kw'>def</span> <span class='id identifier rubyid_five_referrals'>five_referrals</span><span class='lparen'>(</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Congratulations!</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>five_referrals</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="interview_notification-instance_method">
  
    - (<tt>Object</tt>) <strong>interview_notification</strong>(teacher_id, job_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55
56
57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_interview_notification'>interview_notification</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='comma'>,</span> <span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>  
	<span class='ivar'>@teacher</span> <span class='op'>=</span> <span class='const'>Teacher</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@teacher</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>You have a new interview request!</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>interview_notification</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="interview_scheduled-instance_method">
  
    - (<tt>Object</tt>) <strong>interview_scheduled</strong>(user_id, job_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_interview_scheduled'>interview_scheduled</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span> <span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher_user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>

	<span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>
	<span class='ivar'>@school</span> <span class='op'>=</span> <span class='const'>School</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@job</span><span class='period'>.</span><span class='id identifier rubyid_school_id'>school_id</span><span class='rparen'>)</span>
	<span class='ivar'>@admin_user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@school</span><span class='period'>.</span><span class='id identifier rubyid_owned_by'>owned_by</span><span class='rparen'>)</span>

	<span class='id identifier rubyid_message_body'>message_body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please login to tioki.com to view your interviewee's request.</span><span class='tstring_end'>&quot;</span></span>

	<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@admin_user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teacher_user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> has scheduled an interview</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_message_body'>message_body</span><span class='rparen'>)</span>

	<span class='ivar'>@admins</span> <span class='op'>=</span> <span class='const'>SharedUsers</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:owned_by</span> <span class='op'>=&gt;</span> <span class='ivar'>@admin_user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
	<span class='ivar'>@admins</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_admin'>admin</span><span class='op'>|</span>
		<span class='id identifier rubyid_shared'>shared</span> <span class='op'>=</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_admin'>admin</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_is_limited'>is_limited</span> <span class='op'>==</span><span class='kw'>false</span>
			<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teacher_user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> has scheduled an interview</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_message_body'>message_body</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='ivar'>@limitedusers</span> <span class='op'>=</span> <span class='const'>SharedSchool</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:school_id</span> <span class='op'>=&gt;</span> <span class='ivar'>@school</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span>
	<span class='ivar'>@limitedusers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_limiteduser'>limiteduser</span><span class='op'>|</span>
		<span class='id identifier rubyid_shared'>shared</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_limiteduser'>limiteduser</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teacher_user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> has scheduled an interview</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_message_body'>message_body</span><span class='rparen'>)</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="message_notification-instance_method">
  
    - (<tt>Object</tt>) <strong>message_notification</strong>(user_id, subject, body, id, name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_message_notification'>message_notification</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@subject</span> <span class='op'>=</span> <span class='id identifier rubyid_subject'>subject</span>
	<span class='ivar'>@message_body</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>140</span><span class='rbracket'>]</span>
	<span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@sender_name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_name'>name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> messaged you: </span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>message_notification</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="refer_job_email-instance_method">
  
    - (<tt>Object</tt>) <strong>refer_job_email</strong>(teachername, job_id, name, emails) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refer_job_email'>refer_job_email</span><span class='lparen'>(</span><span class='id identifier rubyid_teachername'>teachername</span><span class='comma'>,</span> <span class='id identifier rubyid_job_id'>job_id</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='rparen'>)</span>
	<span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>
	<span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
	<span class='ivar'>@teachername</span> <span class='op'>=</span> <span class='id identifier rubyid_teachername'>teachername</span>

	<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span>  <span class='ivar'>@teachername</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> has referred you to a job, </span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='ivar'>@job</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> on Tioki!!</span><span class='tstring_end'>'</span></span>

	<span class='comment'># Which template to use
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:refer_job</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refer_job_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='comment'># Send out the email
</span>	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
		<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
	<span class='kw'>end</span>
	<span class='comment'>#:body =&gt; &quot;Hi #{name}! &quot;+@teacher_user.name+&quot; wants you too check out the job, &quot;+@job.title+&quot;, posted by &quot;+@job.school.name+&quot; on Demo Lesson! Click on the following link to view the job posting: http://www.demolesson.com/jobs/#{@job.id}\n\nIf you have any questions or need additional support please contact us at support@tioki.com.&quot;)
</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>refer_job_email:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="refer_site_email-instance_method">
  
    - (<tt>Object</tt>) <strong>refer_site_email</strong>(teachername, emails, message, user = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 219</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refer_site_email'>refer_site_email</span><span class='lparen'>(</span><span class='id identifier rubyid_teachername'>teachername</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>

	<span class='comment'># Set variables for use inside the email itself
</span>	<span class='ivar'>@teachername</span> <span class='op'>=</span> <span class='id identifier rubyid_teachername'>teachername</span>
	<span class='ivar'>@message</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span>

	<span class='comment'># Get the refering ID
</span>	<span class='ivar'>@referer</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

	<span class='comment'># Set the subject for the email
</span>	<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span>  <span class='ivar'>@teachername</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> wants you to check out Tioki!</span><span class='tstring_end'>'</span></span>

	<span class='comment'># Which template to use
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:refer_site_generic</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refer_site_generic_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='comment'># Send out the email
</span>	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
		<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>refer_site_email:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rejection_notification-instance_method">
  
    - (<tt>Object</tt>) <strong>rejection_notification</strong>(teacher_id, job_id, name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294
295
296
297
298
299
300
301
302
303
304
305
306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 292</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rejection_notification'>rejection_notification</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='comma'>,</span> <span class='id identifier rubyid_job_id'>job_id</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>  
	<span class='ivar'>@teacher</span> <span class='op'>=</span> <span class='const'>Teacher</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='rparen'>)</span>
	<span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@teacher</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@school</span> <span class='op'>=</span> <span class='const'>School</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@job</span><span class='period'>.</span><span class='id identifier rubyid_school_id'>school_id</span><span class='rparen'>)</span>
	<span class='ivar'>@admin_user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@school</span><span class='period'>.</span><span class='id identifier rubyid_owned_by'>owned_by</span><span class='rparen'>)</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Your application status has changed.</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rejection_notification</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="school_signup_email-instance_method">
  
    - (<tt>Object</tt>) <strong>school_signup_email</strong>(name, schoolname, email, phonenumber, school) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


279
280
281
282
283
284
285
286
287
288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 279</span>

<span class='kw'>def</span> <span class='id identifier rubyid_school_signup_email'>school_signup_email</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schoolname'>schoolname</span><span class='comma'>,</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_phonenumber'>phonenumber</span><span class='comma'>,</span> <span class='id identifier rubyid_school'>school</span><span class='rparen'>)</span>
	<span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
	<span class='ivar'>@schoolname</span> <span class='op'>=</span> <span class='id identifier rubyid_schoolname'>schoolname</span>
	<span class='ivar'>@email</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span>
	<span class='ivar'>@phonenumber</span> <span class='op'>=</span> <span class='id identifier rubyid_phonenumber'>phonenumber</span>

	<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span>  <span class='ivar'>@schoolname</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> just signed up to Tioki for a free trial, please contact them to discuss their free trial.</span><span class='tstring_end'>'</span></span>
	<span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Name:</span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span><span class='ivar'>@name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\nSchool name:</span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span><span class='ivar'>@schoolname</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\nPhone Number:</span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span><span class='ivar'>@phonenumber</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\nhttp://www.tioki.com/schools/</span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>

	<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>schumacher.hodge@tioki.com</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>support@tioki.com</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_passcode-instance_method">
  
    - (<tt>Object</tt>) <strong>send_passcode</strong>(name, email) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160
161
162
163
164
165
166
167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_passcode'>send_passcode</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span>
	<span class='ivar'>@passcode</span> <span class='op'>=</span> <span class='const'>Passcode</span><span class='period'>.</span><span class='id identifier rubyid_find_by_given_out'>find_by_given_out</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>
	<span class='ivar'>@passcode</span><span class='period'>.</span><span class='id identifier rubyid_given_out'>given_out</span> <span class='op'>=</span> <span class='kw'>true</span>
	<span class='ivar'>@passcode</span><span class='period'>.</span><span class='id identifier rubyid_sent_to'>sent_to</span> <span class='op'>=</span> <span class='id identifier rubyid_email'>email</span>
	<span class='ivar'>@passcode</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Welcome to Tioki!</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:body</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello and Welcome to Tioki!\n\nWe are thrilled to give you access to our revolutionary online hiring platform and cannot wait for you to start building your very own Tioki profile! Below you will find your personalized code that will grant you access to the site, as well as important terms of service you are agreeing to by signing up as a beta tester.\n\n 1) In appreciation for signing up as a beta tester, we will grant you FREE access to our site through March 31, 2012!\n\n 2) Please note that the site you are accessing is a soft launch of the site and does not represent the final product. We will add additional features in the future to optimize your experience!\n\n 3) Once you are on the site, please be sure to check out our exemplar profile page (the link is in the \&quot;Edit Profile\&quot; section of the site).  Also, please take the time to participate in our beta user survey, which will be emailed to you after you access the platform.\n\n 4) By clicking on the link below, you agree that this is a private and individual code for beta-testing purposes and that it is NOT TO BE SHARED with others. By clicking on the link below, you will gain access to the site, and be directed to create your personal url:\n\nhttp://tioki.com/signup?passcode=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@passcode</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span><span class='rbrace'>}</span><span class='tstring_content'>\n\nIf you have any questions or need additional support please contact us at support@tioki.com.\n\nAgain, welcome to Tioki! We look forward to working with you to meet all your job searching needs!\n\nThe Tioki Team\n(323) 786-3366\ninfo@tioki.com</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

		<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
			<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>send_passcode</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="teacher_applied-instance_method">
  
    - (<tt>Object</tt>) <strong>teacher_applied</strong>(school_id, job_id, teacher_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_teacher_applied'>teacher_applied</span><span class='lparen'>(</span><span class='id identifier rubyid_school_id'>school_id</span><span class='comma'>,</span> <span class='id identifier rubyid_job_id'>job_id</span><span class='comma'>,</span> <span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='rparen'>)</span>
	<span class='ivar'>@school</span> <span class='op'>=</span> <span class='const'>School</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_school_id'>school_id</span><span class='rparen'>)</span>
	<span class='ivar'>@admin_user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@school</span><span class='period'>.</span><span class='id identifier rubyid_owned_by'>owned_by</span><span class='rparen'>)</span>

	<span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_job_id'>job_id</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher</span> <span class='op'>=</span> <span class='const'>Teacher</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher_id'>teacher_id</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher_user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@teacher</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>

	<span class='id identifier rubyid_message_body'>message_body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please login to tioki.com to respond to this request.</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='ivar'>@teacher_user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> applied to your job posting: </span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='ivar'>@job</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span>

	<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@admin_user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>

	<span class='ivar'>@admins</span> <span class='op'>=</span> <span class='const'>SharedUsers</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:owned_by</span> <span class='op'>=&gt;</span> <span class='ivar'>@admin_user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
	<span class='ivar'>@admins</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_admin'>admin</span><span class='op'>|</span>
		<span class='id identifier rubyid_shared'>shared</span> <span class='op'>=</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_admin'>admin</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_is_limited'>is_limited</span> <span class='op'>==</span><span class='kw'>false</span>
			<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='ivar'>@limitedusers</span> <span class='op'>=</span> <span class='const'>SharedSchool</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:school_id</span> <span class='op'>=&gt;</span> <span class='ivar'>@school</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span>
	<span class='ivar'>@limitedusers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_limiteduser'>limiteduser</span><span class='op'>|</span>
		<span class='id identifier rubyid_shared'>shared</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_limiteduser'>limiteduser</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_shared'>shared</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="teacher_welcome_email-instance_method">
  
    - (<tt>Object</tt>) <strong>teacher_welcome_email</strong>(user_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_teacher_welcome_email'>teacher_welcome_email</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher</span> <span class='op'>=</span> <span class='const'>Teacher</span><span class='period'>.</span><span class='id identifier rubyid_find_by_user_id'>find_by_user_id</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>

	<span class='comment'># Get ab test number
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:teacher_welcome</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>teacher_welcome_email_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Welcome to Tioki!</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
		<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>teacher_welcome_email:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="teacher_welcome_email_temppassword-instance_method">
  
    - (<tt>Object</tt>) <strong>teacher_welcome_email_temppassword</strong>(user_id, password) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_teacher_welcome_email_temppassword'>teacher_welcome_email_temppassword</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher</span> <span class='op'>=</span> <span class='const'>Teacher</span><span class='period'>.</span><span class='id identifier rubyid_find_by_user_id'>find_by_user_id</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@password</span> <span class='op'>=</span> <span class='id identifier rubyid_password'>password</span>

	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Welcome to Tioki!</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>teacher_welcome_email_temppassword</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="userconnect-instance_method">
  
    - (<tt>Object</tt>) <strong>userconnect</strong>(owner_id, user_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_userconnect'>userconnect</span><span class='lparen'>(</span><span class='id identifier rubyid_owner_id'>owner_id</span><span class='comma'>,</span> <span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
	<span class='ivar'>@owner</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_owner_id'>owner_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>

	<span class='comment'># Get the proper AB Test string
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:userconnect</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>userconnect_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_ab'>ab</span> <span class='op'>==</span> <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
		<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>You have a new connection!</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
			<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pending Tioki connection with </span><span class='embexpr_beg'>#{</span><span class='ivar'>@owner</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
			<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>userconnect:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vouch_request-instance_method">
  
    - (<tt>Object</tt>) <strong>vouch_request</strong>(voucheename, vouchername, emails, url) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 393</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vouch_request'>vouch_request</span><span class='lparen'>(</span><span class='id identifier rubyid_voucheename'>voucheename</span><span class='comma'>,</span> <span class='id identifier rubyid_vouchername'>vouchername</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
	<span class='ivar'>@url</span> <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span>
	<span class='ivar'>@teachername</span> <span class='op'>=</span> <span class='id identifier rubyid_voucheename'>voucheename</span>
	<span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_vouchername'>vouchername</span>

	<span class='comment'># Which template to use
</span>	<span class='id identifier rubyid_ab'>ab</span> <span class='op'>=</span> <span class='const'>Abtests</span><span class='period'>.</span><span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:vouch_request</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
	<span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>vouch_request_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span>

	<span class='comment'># Send out the email
</span>	<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='ivar'>@teachername</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> has requested to verify their skills on Tioki</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
		<span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='id identifier rubyid_template'>template</span> <span class='rbrace'>}</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>vouch_request:ab-</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_ab'>ab</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="weeklyemail-instance_method">
  
    - (<tt>Object</tt>) <strong>weeklyemail</strong>(teacher) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/mailers/user_mailer.rb', line 308</span>

<span class='kw'>def</span> <span class='id identifier rubyid_weeklyemail'>weeklyemail</span><span class='lparen'>(</span><span class='id identifier rubyid_teacher'>teacher</span><span class='rparen'>)</span>
	<span class='ivar'>@teacher</span><span class='op'>=</span><span class='id identifier rubyid_teacher'>teacher</span>
	<span class='comment'>#keywords for finding grades
</span>	<span class='id identifier rubyid_gradestring'>gradestring</span><span class='op'>=</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>K</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>6</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>7</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>10</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>11</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>12</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>elementary</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>middle</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>high</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pre</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>adult</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

	<span class='comment'>#must have emails enabled, be currently teacher
</span>	<span class='comment'>#Still testing so emails are going to elijahgreen@gmail.com only
</span>	<span class='id identifier rubyid_tup'>tup</span> <span class='op'>=</span> <span class='const'>SmartTuple</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> AND </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
	<span class='id identifier rubyid_tup'>tup</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>jobs.created_at &gt; ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_today'>today</span><span class='op'>-</span> <span class='int'>7</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='rbracket'>]</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_location'>seeking_location</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
		<span class='comment'>#A loaction is a specific point in that location so a radius is needed.
</span>		<span class='comment'>#Currently a 25 miles radius
</span>		<span class='id identifier rubyid_schools'>schools</span> <span class='op'>=</span> <span class='const'>School</span><span class='period'>.</span><span class='id identifier rubyid_near'>near</span><span class='lparen'>(</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_location'>seeking_location</span><span class='comma'>,</span> <span class='int'>25</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:id</span><span class='rparen'>)</span>

		<span class='comment'>#if no schools go to next teacher
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_schools'>schools</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
			<span class='kw'>return</span>
		<span class='kw'>else</span>
			<span class='ivar'>@jobs</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:school_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_schools'>schools</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_tup'>tup</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>else</span>
		<span class='ivar'>@jobs</span> <span class='op'>=</span> <span class='const'>Job</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_tup'>tup</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
		<span class='id identifier rubyid_jobarray'>jobarray</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

		<span class='comment'>#Elementary grades, K-6
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_gradestring'>gradestring</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>6</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_str'>str</span><span class='op'>|</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_str'>str</span> <span class='rbrace'>}</span> <span class='op'>||</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>elementary</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='comment'>#2=elementary,7=K-6,8=K-8,10=K-12
</span>			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>2</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>8</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>10</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>

		<span class='comment'>#Middle grades, 6-8 
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_gradestring'>gradestring</span><span class='lbracket'>[</span><span class='int'>6</span><span class='op'>..</span><span class='int'>8</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_str'>str</span><span class='op'>|</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_str'>str</span> <span class='rbrace'>}</span> <span class='op'>||</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>middle</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='comment'>#3=middle,8=K-8,9=6-12, 10=K-12
</span>			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>3</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>8</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>9</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>10</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>

		<span class='comment'>#High school grades, K-12
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_gradestring'>gradestring</span><span class='lbracket'>[</span><span class='int'>9</span><span class='op'>..</span><span class='int'>12</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_str'>str</span><span class='op'>|</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_str'>str</span> <span class='rbrace'>}</span> <span class='op'>||</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>high</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='comment'>#10=K-12, 9=6-12, 4 = high school
</span>			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>9</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>10</span> <span class='op'>||</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>4</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>

		<span class='comment'>#Pre-school
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pre</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='comment'>#1=pre-K
</span>			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>

		<span class='comment'>#Adult School
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_grade'>seeking_grade</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>adult</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_school'>school</span><span class='period'>.</span><span class='id identifier rubyid_grades'>grades</span> <span class='op'>==</span> <span class='int'>5</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>

		<span class='ivar'>@jobs</span><span class='op'>=</span><span class='id identifier rubyid_jobarray'>jobarray</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_subject'>seeking_subject</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
		<span class='comment'>#select subjects whose names is in seeking_subject
</span>		<span class='ivar'>@subjects</span><span class='op'>=</span><span class='const'>Subject</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_subject'>subject</span><span class='op'>|</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_seeking_subject'>seeking_subject</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>

		<span class='id identifier rubyid_jobarray'>jobarray</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

		<span class='comment'>#any jobs with a particular subject is added to the array, because of this there are possibly duplicates
</span>		<span class='ivar'>@subjects</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subject'>subject</span><span class='op'>|</span>
			<span class='id identifier rubyid_jobarray'>jobarray</span><span class='op'>+=</span><span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span> <span class='const'>JobsSubjects</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:first</span><span class='comma'>,</span> <span class='symbol'>:conditions</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>job_id = ? AND subject_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='rbrace'>}</span>
		<span class='kw'>end</span>
		<span class='comment'>#make sure that every job of the jobs array is unique
</span>		<span class='ivar'>@jobs</span><span class='op'>=</span><span class='id identifier rubyid_jobarray'>jobarray</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='ivar'>@jobs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>
		<span class='id identifier rubyid_mail'>mail</span> <span class='op'>=</span> <span class='id identifier rubyid_mail'>mail</span><span class='lparen'>(</span><span class='symbol'>:to</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_teacher'>teacher</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='symbol'>:subject</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New job postings at tioki.com</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>tag</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
		<span class='id identifier rubyid_mail'>mail</span><span class='period'>.</span><span class='id identifier rubyid_delivery_method'>delivery_method</span><span class='period'>.</span><span class='id identifier rubyid_tag'>tag</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>weeklyemail</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_mail'>mail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Oct 11 16:47:21 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.9.3).
</div>

  </body>
</html>