<div id="completion">
	<div id="completionHeader">
		<h3 style="color:#fff; margin-top:0;margin-bottom:5px;">
			<div class="text_occupation" style="display:none">
				Are you a teacher, admin, or professor?
			</div>
			<div class="text_location" style="display:none">
				Help your friends find you.
			</div>
			<div class="text_headline" style="display:none">
				Tell us a bit about yourself
			</div>
			<div class="text_picture" style="display:none">
				Help the Tioki Network recognize you
			</div>
			<div class="text_social" style="display:none">
				Connect your social networks for better sharing
			</div>
			<div class="text_subjects" style="display:none">
				Let the world know what subjects you specialize in
			</div>
			<div class="text_skills" style="display:none">
				Skills make us unique.  What are some of your?
			</div>
			<div class="text_education" style="display:none">
				Find your classmates and school networks
			</div>
			<div class="text_experience" style="display:none">
				You're a professional.  Tell us where you practice
			</div>
			<div class="text_video" style="display:none">
				Add a video of you in the classroom
			</div>
		</h3>
		<div id="completionIcons">
			<p style="font-size:17px;color:#fff;margin-top:0px">
				<% ctr = -1 %>
				<% if @completions.include?("occupation") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/occupation_unselected.png', :class => "popup_occupation", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("location") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/location_unselected.png', :class => "popup_location", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("headline") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/headline_unselected.png', :class => "popup_headline", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("picture") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/picture_unselected.png', :class => "popup_picture" ,:style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("social") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/social_unselected.png', :class => "popup_social", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("subjects") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/subjects_unselected.png', :class => "popup_subjects", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link",:data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("skills") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/skills_unselected.png', :class => "popup_skills", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("education") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/education_unselected.png', :class => "popup_education", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
				<% end %>
				&middot;
				<% if @completions.include?("experience") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/experience_unselected.png', :class => "popup_experience", :style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => {:complete => ctr += 1} %>
					&middot;
				<% end %>
				<% if @completions.include?("video") %>
					<%= link_to image_tag('/assets/tioki/completion_icons2/video_unselected.png', :class => "popup_video",:style => "width:30px;margin-bottom:-10px;"), '#', :class => "image_link", :data => { :complete => ctr += 1} %>
				<% end %>

			</p>
		</div>
	</div>

	<section class="section_occupation" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "occupation_form", :remote => true do %>
				Occupation<br />
				<%= select_tag "user[occupation]", options_for_select(User::OCCUPATION) %><br />
				Are you currently seeking employment?<br />
				<select name="user[job_seeking]">
					<option value="yes">Yes</option>
					<option value="no">No</option>
				</select>
		<% end %>
	</section>

	<section class="section_location" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "location_form", :remote => true do %>
			<p>
				I currently live in... <%= text_field_tag "user[location]", currentUser.location, :placeholder => "Los Angeles, CA", :style => ":width:250px" %>
			</p>
		<% end %>
	</section>

	<section class="section_headline" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "headline_form", :remote => true do %>
				Headline<br />
				<%= text_area_tag "user[headline]", currentUser.headline %>
		<% end %>
	</section>

	<section class="section_picture" style="display:none">
		<p>
		Help connections and the rest of the Tioki community recognize you. 
		</p>
		<div style="text-align:center">
			<% if currentUser.avatar? %>
				<%= image_tag currentUser.avatar.url(:medium), :style => "width:250px;border:5px solid #f1f1f1;" %>
			<% else %>
				<%= image_tag 'dl_icons/no_avatar_large.jpg', :style => "width:250px;border:5px solid #f1f1f1;" %>
			<% end %>
			<br/>
			<%= link_to 'Upload Picture', '/me/profile/edit/upload-avatar', :style => 'color:#F66C4C' %>
		</div>
	</section>

	<section class="section_social" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "social_form", :remote => true do %>
			<p>
				<%= image_tag('tioki/icons/LinkedIn_IN_Icon_25px.png', :border => 0, :style=>"margin-bottom:-7px;") %>
				<%= text_field_tag 'social[linkedin]', currentUser.social[:linkedin] ,:placeholder => "http://www.linkedin.com/" %>
			</p>
			<p>
				<%= image_tag('tioki/icons/twitter2.png', :border => 0, :style=>"margin-bottom:-7px;") %>
				<%= text_field_tag 'social[twitter]', currentUser.social[:twitter] ,:placeholder => "http://twitter.com/" %>
			</p>
			<p>
				<%= image_tag('tioki/icons/pinterest.png', :border => 0, :style=>"margin-bottom:-7px;") %>
				<%= text_field_tag 'social[pinterest]', currentUser.social[:pinterest], :placeholder => "http://www.pinterest.com/" %>
			</p>
			<p>
				<%= image_tag('tioki/icons/edmodo.png', :border => 0, :style=>"margin-bottom:-7px;") %>
				<%= text_field_tag 'social[edmodo]', currentUser.social[:edmodo], :placeholder => "http://www.edmodo.com/" %>
			</p>
			<p>
				<%= image_tag('tioki/icons/betterlesson.png', :border => 0, :style=>"margin-bottom:-7px;") %>
				<%= text_field_tag 'social[betterlesson]', currentUser.social[:betterlesson],:placeholder => "http://betterlesson.com/" %>
			</p>
			<p>
				<%= image_tag('tioki/icons/teachingchannel.png', :border => 0, :style=>"margin-bottom:-9px;") %>
				<%= text_field_tag 'social[teachingchannel]', currentUser.social[:teachingchannel], :placeholder => "http://www.teachingchannel.org/" %>
			</p>
		<% end %>
	</section>

	<section class="section_subjects" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "subjects_form", :remote => true do %>
			Subjects:
			<input type="text" id="profile_subjects" name="user[subject]" />
			Grades:
			<input type="text" id="profile_subjects" name="user[grade]" />
		<% end %>
	</section>

	<section class="section_skills" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "skills_form", :remote => true do %>
			Skills:
			<input type="text" name="user[skill]" />
		<% end %>
	</section>

	<section class="section_education" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "education_form", :remote => true do |f| %>
			<fieldset>
				<p>
				School/University
				</p>
				<%= text_field_tag "education[school]" %>
			</fieldset>
			<fieldset>
				<p>
				Degree
				</p>
				<%= text_field_tag "education[degree]", nil, :placeholder => "(e.g. B.A, Masters, etc.)" %>
			</fieldset>
			<fieldset>
				<p>
				Major
				</p>
				<%= text_field_tag "education[concentrations]", nil, :placeholder => "(e.g. Sociology, Chemistry, etc.)" %>
			</fieldset>
			<fieldset>
				<p>
				Start Year: 
				<%= select("education", "start_year", YEARS_ARRAY.reverse, :include_blank => true) %>
				</p>	
			</fielset>
			<fieldset>
				<p>
				Graduation Year: 
				<%= select("education", "year", YEARS_ARRAY.reverse, :include_blank => true) %>	
				</p>
			</fieldset>	
			<fieldset>
				<label>
					<%= check_box_tag "education[current]" %> 
					I am currently attending here
				</label>
			</fieldset>
		<% end %>

	</section>

	<section class="section_experience" style="display:none">
		<%= form_tag "/me/profile/edit/complete", :class => "experience_form", :remote => true do |f| %>
			<fieldset>
				<p>
				Company, District or School
				</p>
				<%= text_field_tag "experience[company]" %>
			</fieldset>
			<fieldset>
				<p>
				Start Date: 
				<%= select_month(Date.today, :add_month_numbers => false, :field_name => :startMonth) %>
				<%= select_year(Date.today, :field_name => "startYear", :start_year => 1940, :end_year => Time.now.year+1) %>
				</p>
			</fieldset>
			<fieldset>
				<p>
				End Date:
				<%= select_month(Date.today, :add_month_numbers => false, :field_name => :endMonth) %>
				<%= select_year(Date.today, :field_name => "endYear", :start_year => 1940, :end_year => Time.now.year+1) %>
				</p>
			</fieldset>
			<fieldset>
				<label>
					<%= check_box_tag 'experience[current]', 'yes', false, :class => 'current' %> 
					I currently work here
				</label>
			</fieldset>
			<fieldset>
				<p>
				Title/Position
				</p>
				<%= text_field_tag "experience[position]" %>
			</fieldset>
		<% end %>

	</section>

	<section class="section_video" style="display:none">
		Videos:<br />
		<%= link_to "Upload video", new_video_path %>
	</section>

	<section>
		<%= link_to '<<Previous', '#', :class => "completionPrevious previous" %>
		<%= link_to 'Skip', '#', :class => "completionPrevious skip", :id => "skip_completion" %>
		<%= link_to 'Save & continue>>', '#', :class => "completionContinue" %>
	</section>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		var completions = <%= @completions.to_json.html_safe %>;
		var completionsIndex = 0;
		$("#"+completions[completionsIndex]+"_select").show();
		$(".complete_popup").click(function () {
			$('body').completionOverlay({
				completionLength: 10000, // anything numeric no quotes
				transitionSpeed: 400, // ditto
				completionAutoFade: false, //timed fade on overlay...true or false
				completionCloseBtn: true, //btn to close overlay...true or false
				completionTransition: 'fade', //different transition options 'fade', 'slideUp', 'slideLeft', 'slideCenter'
				openAnimation: true, //opening animation...true or false
				completionSwitch: true,
				completionContent: '#completion', //where the content is at, uses css selector # for id, and . for class
				cookieActive : false,
				/* also you can use 'href' to load content for a seperate page..
				when using href it also uses the class of the clicked element to find the content...
				it goes like this .load(href class); check source for use */ 
				completionTemplate: 'full', // either 'full' or 'module'
				completionTurnOffLights: false, //turn off and on lights...true or false
			});
			unselect();
			completionsIndex = parseInt($(this).attr('data-completionid'));
			select();

			$(".previous").on("click", function () {
				unselect();
				if(completionsIndex > 0) {
					completionsIndex--;
				} else {
					completionsIndex = completions.length - 1;
				}
				select();
			});

			$(".skip").on("click", function () {
				unselect();
				if(completionsIndex < completions.length - 1) {
					completionsIndex++;
				} else {
					completionsIndex = 0;
				}
				select();
			});
			
			$(".completionContinue").on("click", function () {
				$("."+completions[completionsIndex]+"_form").last().submit();
				$(".skip").last().click();
			});

			$(".image_link").on("click", function () {
				$(".section_"+completions[completionsIndex]).hide();
				$(".text_"+completions[completionsIndex]).hide();
				$(".popup_"+completions[completionsIndex]).attr("src", "/assets/tioki/completion_icons2/"+completions[completionsIndex]+"_unselected.png");
				completionsIndex = parseInt($(this).attr('data-complete'));
				$(".section_"+completions[completionsIndex]).show();
				$(".text_"+completions[completionsIndex]).show();
				$(".popup_"+completions[completionsIndex]).attr("src", "/assets/tioki/completion_icons2/"+completions[completionsIndex]+"_selected.png");
			});

			 $('input[name="user[subject]"]').tokenInput("/api/subjects", {
				 hintText: "Subjects...",
				 theme: "facebook",
				 resultsLimit: 10,
				 prePopulate: 
				 <%= currentUser.subjects.to_json(:only => [:id, :name] ).html_safe %>
			 });
			 $('input[name="user[grade]"]').tokenInput("/api/grades", {
				 hintText: "Grades...",
				 theme: "facebook",
				 resultsLimit: 10,
				 prePopulate: 
				 <%= currentUser.grades.to_json(:only => [:id, :name] ).html_safe %>
			 });
				$('input[name="user[skill]"]').tokenInput("/api/skills", {
					hintText: "Skills...",
					theme: "facebook",
					resultsLimit: 10,
					prePopulate: <%= currentUser.skills.to_json(:only => [:id, :name]).html_safe %>
				});
			});

		$(".complete_popup").click(function (e) {
			e.preventDefault();
			$("#profile_complete").click();
		});
		function unselect()
		{
			$(".section_"+completions[completionsIndex]).hide();
			$(".text_"+completions[completionsIndex]).hide();
			$(".popup_"+completions[completionsIndex]).attr("src", "/assets/tioki/completion_icons2/"+completions[completionsIndex]+"_unselected.png");
		}
		function select()
		{
			$(".section_"+completions[completionsIndex]).show();
			$(".text_"+completions[completionsIndex]).show();
			$(".popup_"+completions[completionsIndex]).attr("src", "/assets/tioki/completion_icons2/"+completions[completionsIndex]+"_selected.png");
		}
		function unselectpopupAll()
		{
			temp = completionsIndex;
			for(var i = 0; i < completions.length; i++){
				completionsIndex = i;
				unselect();
			}
			completionsIndex = temp;
		}
		function unselectcompleteAll()
		{
			temp = completionsIndex;
			for(var i = 0; i < completions.length; i++){
				completionsIndex = i;
				$("#"+completions[completionsIndex]+"_select").hide();
			}
			completionsIndex = temp;
		}
		$("#completion_right").click( function () {
			unselect();
			unselectcompleteAll();
			$("#"+completions[completionsIndex]+"_select").hide();
			if(completionsIndex < completions.length - 1) {
				completionsIndex++;
			} else {
				completionsIndex = 0;
			}
			$("#"+completions[completionsIndex]+"_select").fadeIn();
			select();
		});
		$("#completion_left").click( function () {
			unselect();
			unselectcompleteAll();
			$("#"+completions[completionsIndex]+"_select").hide();
			if(completionsIndex > 0) {
				completionsIndex--;
			} else {
				completionsIndex = completions.length - 1;
			}
			select();
			$("#"+completions[completionsIndex]+"_select").fadeIn();
		});
	});
</script>

